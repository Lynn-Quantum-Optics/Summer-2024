from qutip import *
from math import sqrt, cos, sin
import numpy as np
from gen_state import make_W_list
from rho_methods_ONLYGOOD import compute_witnesses, get_rho
import matplotlib.pyplot as plt


# Basis Notes: 
H = basis(2,0) # ket 1
V = basis(2,1) # ket 2
D = 1/sqrt(2) * (H + V)
A = 1/sqrt(2) * (H - V)
R = 1/sqrt(2)*(H + 1j*V)
L = 1/sqrt(2)*(H - 1j*V)

# if it is witnessed, which W is it witnessed by
# check if states in W are witnessed by other W

state_D = {0: H, 1: V, 2: D, 3: A, 4: R, 5: L}
state_label_D = {0: "H", 1: "V", 2: "D", 3: "A", 4: "R", 5: "L"}

phi_L = np.linspace(0,np.pi, 3)
theta_L = np.linspace(0,2*np.pi, 3)[1:]

missed_states = {'W':[],'Wp':[]}

iteration = 0
# scan over a bunch of possible combos
for phi in phi_L:
    for theta in theta_L:
        for i in range(len(state_D)):
            iteration += 1
            state_1 = state_D[i]
            state_2 = state_D[len(state_D)- 1 - i]
            curr_state = cos(theta)*tensor(state_1, state_2) + sin(theta)*np.exp(1j*phi)*tensor(state_1,state_2)
            curr_rho = ket2dm(curr_state).full()


            curr_wit_W = min(compute_witnesses(curr_rho)[0][:6])
            curr_wit_Wp = min(compute_witnesses(curr_rho)[0][6:])

            if curr_wit_W >= 0:
                missed_states['W'] += [(np.degrees(theta),np.degrees(phi), state_label_D[i], state_label_D[len(state_D)- 1 - i])]
            if curr_wit_Wp >= 0:
                missed_states['Wp'] += [(np.degrees(theta), np.degrees(phi), state_label_D[i], state_label_D[len(state_D)- 1 - i])]
            print(iteration)

print("Missed by Wp", missed_states['Wp'])
print("Missed by W", missed_states['W'])




"""
Missed by Wp [(59.99999999999999, 0.0, 'H', 'L'), (59.99999999999999, 0.0, 'V', 'R'), (119.99999999999999, 0.0, 'H', 'L'), (119.99999999999999, 0.0, 'V', 'R'), (119.99999999999999, 0.0, 'R', 'V'), (119.99999999999999, 0.0, 'L', 'H'), (180.0, 0.0, 'H', 'L'), (180.0, 0.0, 'R', 'V'), (180.0, 0.0, 'L', 'H'), (239.99999999999997, 0.0, 'H', 'L'), (239.99999999999997, 0.0, 'V', 'R'), (239.99999999999997, 0.0, 'L', 'H'), (299.99999999999994, 0.0, 'H', 'L'), (299.99999999999994, 0.0, 'V', 'R'), (299.99999999999994, 0.0, 'L', 'H'), (360.0, 0.0, 'H', 'L'), (360.0, 0.0, 'R', 'V'), (59.99999999999999, 36.0, 'H', 'L'), (59.99999999999999, 36.0, 'V', 'R'), (119.99999999999999, 36.0, 'V', 'R'), (119.99999999999999, 36.0, 'L', 'H'), (180.0, 36.0, 'H', 'L'), (180.0, 36.0, 'R', 'V'), (239.99999999999997, 36.0, 'H', 'L'), (239.99999999999997, 36.0, 'V', 'R'), (239.99999999999997, 36.0, 'R', 'V'), (299.99999999999994, 36.0, 'H', 'L'), (299.99999999999994, 36.0, 'V', 'R'), (299.99999999999994, 36.0, 'R', 'V'), (299.99999999999994, 36.0, 'L', 'H'), (360.0, 36.0, 'H', 'L'), (360.0, 36.0, 'R', 'V'), (59.99999999999999, 72.0, 'V', 'R'), (59.99999999999999, 72.0, 'L', 'H'), (119.99999999999999, 72.0, 'V', 'R'), (119.99999999999999, 72.0, 'R', 'V'), (180.0, 72.0, 'H', 'L'), (180.0, 72.0, 'R', 'V'), (180.0, 72.0, 'L', 'H'), (299.99999999999994, 72.0, 'V', 'R'), (360.0, 72.0, 'H', 'L'), (360.0, 72.0, 'L', 'H'), (59.99999999999999, 108.0, 'L', 'H'), (119.99999999999999, 108.0, 'H', 'L'), (119.99999999999999, 108.0, 'L', 'H'), (180.0, 108.0, 'H', 'L'), (180.0, 108.0, 'L', 'H'), (239.99999999999997, 108.0, 'R', 'V'), (239.99999999999997, 108.0, 'L', 'H'), (299.99999999999994, 108.0, 'H', 'L'), (299.99999999999994, 108.0, 'V', 'R'), (360.0, 108.0, 'H', 'L'), (360.0, 108.0, 'R', 'V'), (360.0, 108.0, 'L', 'H'), (59.99999999999999, 144.0, 'H', 'L'), (59.99999999999999, 144.0, 'R', 'V'), (59.99999999999999, 144.0, 'L', 'H'), (119.99999999999999, 144.0, 'H', 'L'), (119.99999999999999, 144.0, 'V', 'R'), (119.99999999999999, 144.0, 'R', 'V'), (180.0, 144.0, 'H', 'L'), (180.0, 144.0, 'L', 'H'), (239.99999999999997, 144.0, 'H', 'L'), (239.99999999999997, 144.0, 'R', 'V'), (239.99999999999997, 144.0, 'L', 'H'), (299.99999999999994, 144.0, 'V', 'R'), (299.99999999999994, 144.0, 'R', 'V'), (299.99999999999994, 144.0, 'L', 'H'), (360.0, 144.0, 'H', 'L'), (59.99999999999999, 180.0, 'H', 'L'), (59.99999999999999, 180.0, 'V', 'R'), (59.99999999999999, 180.0, 'R', 'V'), (119.99999999999999, 180.0, 'H', 'L'), (119.99999999999999, 180.0, 'V', 'R'), (180.0, 180.0, 'H', 'L'), (180.0, 180.0, 'L', 'H'), (239.99999999999997, 180.0, 'H', 'L'), (239.99999999999997, 180.0, 'V', 'R'), (239.99999999999997, 180.0, 'L', 'H'), (299.99999999999994, 180.0, 'H', 'L'), (299.99999999999994, 180.0, 'R', 'V'), (360.0, 180.0, 'H', 'L'), (360.0, 180.0, 'R', 'V'), (360.0, 180.0, 'L', 'H')]
Missed by W [(59.99999999999999, 0.0, 'H', 'L'), (59.99999999999999, 0.0, 'V', 'R'), (59.99999999999999, 0.0, 'D', 'A'), (59.99999999999999, 0.0, 'A', 'D'), (59.99999999999999, 0.0, 'R', 'V'), (59.99999999999999, 0.0, 'L', 'H'), (119.99999999999999, 0.0, 'H', 'L'), (119.99999999999999, 0.0, 'V', 'R'), (119.99999999999999, 0.0, 'D', 'A'), (119.99999999999999, 0.0, 'A', 'D'), (119.99999999999999, 0.0, 'R', 'V'), (119.99999999999999, 0.0, 'L', 'H'), (180.0, 0.0, 'H', 'L'), (180.0, 0.0, 'V', 'R'), (180.0, 0.0, 'D', 'A'), (180.0, 0.0, 'A', 'D'), (180.0, 0.0, 'R', 'V'), (180.0, 0.0, 'L', 'H'), (239.99999999999997, 0.0, 'H', 'L'), (239.99999999999997, 0.0, 'V', 'R'), (239.99999999999997, 0.0, 'D', 'A'), (239.99999999999997, 0.0, 'A', 'D'), (239.99999999999997, 0.0, 'R', 'V'), (239.99999999999997, 0.0, 'L', 'H'), (299.99999999999994, 0.0, 'H', 'L'), (299.99999999999994, 0.0, 'V', 'R'), (299.99999999999994, 0.0, 'D', 'A'), (299.99999999999994, 0.0, 'A', 'D'), (299.99999999999994, 0.0, 'R', 'V'), (299.99999999999994, 0.0, 'L', 'H'), (360.0, 0.0, 'H', 'L'), (360.0, 0.0, 'V', 'R'), (360.0, 0.0, 'D', 'A'), (360.0, 0.0, 'A', 'D'), (360.0, 0.0, 'R', 'V'), (360.0, 0.0, 'L', 'H'), (59.99999999999999, 36.0, 'H', 'L'), (59.99999999999999, 36.0, 'V', 'R'), (59.99999999999999, 36.0, 'D', 'A'), (59.99999999999999, 36.0, 'A', 'D'), (59.99999999999999, 36.0, 'R', 'V'), (59.99999999999999, 36.0, 'L', 'H'), (119.99999999999999, 36.0, 'H', 'L'), (119.99999999999999, 36.0, 'V', 'R'), (119.99999999999999, 36.0, 'D', 'A'), (119.99999999999999, 36.0, 'A', 'D'), (119.99999999999999, 36.0, 'R', 'V'), (119.99999999999999, 36.0, 'L', 'H'), (180.0, 36.0, 'H', 'L'), (180.0, 36.0, 'V', 'R'), (180.0, 36.0, 'D', 'A'), (180.0, 36.0, 'A', 'D'), (180.0, 36.0, 'R', 'V'), (180.0, 36.0, 'L', 'H'), (239.99999999999997, 36.0, 'H', 'L'), (239.99999999999997, 36.0, 'V', 'R'), (239.99999999999997, 36.0, 'D', 'A'), (239.99999999999997, 36.0, 'A', 'D'), (239.99999999999997, 36.0, 'R', 'V'), (239.99999999999997, 36.0, 'L', 'H'), (299.99999999999994, 36.0, 'H', 'L'), (299.99999999999994, 36.0, 'V', 'R'), (299.99999999999994, 36.0, 'D', 'A'), (299.99999999999994, 36.0, 'A', 'D'), (299.99999999999994, 36.0, 'R', 'V'), (299.99999999999994, 36.0, 'L', 'H'), (360.0, 36.0, 'H', 'L'), (360.0, 36.0, 'V', 'R'), (360.0, 36.0, 'D', 'A'), (360.0, 36.0, 'A', 'D'), (360.0, 36.0, 'R', 'V'), (360.0, 36.0, 'L', 'H'), (59.99999999999999, 72.0, 'H', 'L'), (59.99999999999999, 72.0, 'V', 'R'), (59.99999999999999, 72.0, 'D', 'A'), (59.99999999999999, 72.0, 'A', 'D'), (59.99999999999999, 72.0, 'R', 'V'), (59.99999999999999, 72.0, 'L', 'H'), (119.99999999999999, 72.0, 'H', 'L'), (119.99999999999999, 72.0, 'V', 'R'), (119.99999999999999, 72.0, 'D', 'A'), (119.99999999999999, 72.0, 'A', 'D'), (119.99999999999999, 72.0, 'R', 'V'), (119.99999999999999, 72.0, 'L', 'H'), (180.0, 72.0, 'H', 'L'), (180.0, 72.0, 'V', 'R'), (180.0, 72.0, 'D', 'A'), (180.0, 72.0, 'A', 'D'), (180.0, 72.0, 'R', 'V'), (180.0, 72.0, 'L', 'H'), (239.99999999999997, 72.0, 'H', 'L'), (239.99999999999997, 72.0, 'V', 'R'), (239.99999999999997, 72.0, 'D', 'A'), (239.99999999999997, 72.0, 'R', 'V'), (239.99999999999997, 72.0, 'L', 'H'), (299.99999999999994, 72.0, 'H', 'L'), (299.99999999999994, 72.0, 'V', 'R'), (299.99999999999994, 72.0, 'D', 'A'), (299.99999999999994, 72.0, 'A', 'D'), (299.99999999999994, 72.0, 'R', 'V'), (299.99999999999994, 72.0, 'L', 'H'), (360.0, 72.0, 'H', 'L'), (360.0, 72.0, 'V', 'R'), (360.0, 72.0, 'D', 'A'), (360.0, 72.0, 'A', 'D'), (360.0, 72.0, 'R', 'V'), (360.0, 72.0, 'L', 'H'), (59.99999999999999, 108.0, 'H', 'L'), (59.99999999999999, 108.0, 'V', 'R'), (59.99999999999999, 108.0, 'D', 'A'), (59.99999999999999, 108.0, 'A', 'D'), (59.99999999999999, 108.0, 'R', 'V'), (59.99999999999999, 108.0, 'L', 'H'), (119.99999999999999, 108.0, 'H', 'L'), (119.99999999999999, 108.0, 'V', 'R'), (119.99999999999999, 108.0, 'D', 'A'), (119.99999999999999, 108.0, 'R', 'V'), (119.99999999999999, 108.0, 'L', 'H'), (180.0, 108.0, 'H', 'L'), (180.0, 108.0, 'V', 'R'), (180.0, 108.0, 'D', 'A'), (180.0, 108.0, 'A', 'D'), (180.0, 108.0, 'R', 'V'), (180.0, 108.0, 'L', 'H'), (239.99999999999997, 108.0, 'H', 'L'), (239.99999999999997, 108.0, 'V', 'R'), (239.99999999999997, 108.0, 'D', 'A'), (239.99999999999997, 108.0, 'A', 'D'), (239.99999999999997, 108.0, 'R', 'V'), (239.99999999999997, 108.0, 'L', 'H'), (299.99999999999994, 108.0, 'H', 'L'), (299.99999999999994, 108.0, 'V', 'R'), (299.99999999999994, 108.0, 'D', 'A'), (299.99999999999994, 108.0, 'A', 'D'), (299.99999999999994, 108.0, 'R', 'V'), (299.99999999999994, 108.0, 'L', 'H'), (360.0, 108.0, 'H', 'L'), (360.0, 108.0, 'V', 'R'), (360.0, 108.0, 'D', 'A'), (360.0, 108.0, 'A', 'D'), (360.0, 108.0, 'R', 'V'), (360.0, 108.0, 'L', 'H'), (59.99999999999999, 144.0, 'H', 'L'), (59.99999999999999, 144.0, 'V', 'R'), (59.99999999999999, 144.0, 'D', 'A'), (59.99999999999999, 144.0, 'A', 'D'), (59.99999999999999, 144.0, 'R', 'V'), (59.99999999999999, 144.0, 'L', 'H'), (119.99999999999999, 144.0, 'H', 'L'), (119.99999999999999, 144.0, 'V', 'R'), (119.99999999999999, 144.0, 'D', 'A'), (119.99999999999999, 144.0, 'A', 'D'), (119.99999999999999, 144.0, 'R', 'V'), (119.99999999999999, 144.0, 'L', 'H'), (180.0, 144.0, 'H', 'L'), (180.0, 144.0, 'V', 'R'), (180.0, 144.0, 'D', 'A'), (180.0, 144.0, 'A', 'D'), (180.0, 144.0, 'R', 'V'), (180.0, 144.0, 'L', 'H'), (239.99999999999997, 144.0, 'H', 'L'), (239.99999999999997, 144.0, 'V', 'R'), (239.99999999999997, 144.0, 'D', 'A'), (239.99999999999997, 144.0, 'A', 'D'), (239.99999999999997, 144.0, 'R', 'V'), (239.99999999999997, 144.0, 'L', 'H'), (299.99999999999994, 144.0, 'H', 'L'), (299.99999999999994, 144.0, 'V', 'R'), (299.99999999999994, 144.0, 'D', 'A'), (299.99999999999994, 144.0, 'A', 'D'), (299.99999999999994, 144.0, 'R', 'V'), (299.99999999999994, 144.0, 'L', 'H'), (360.0, 144.0, 'H', 'L'), (360.0, 144.0, 'V', 'R'), (360.0, 144.0, 'D', 'A'), (360.0, 144.0, 'A', 'D'), (360.0, 144.0, 'R', 'V'), (360.0, 144.0, 'L', 'H'), (59.99999999999999, 180.0, 'H', 'L'), (59.99999999999999, 180.0, 'V', 'R'), (59.99999999999999, 180.0, 'D', 'A'), (59.99999999999999, 180.0, 'A', 'D'), (59.99999999999999, 180.0, 'R', 'V'), (59.99999999999999, 180.0, 'L', 'H'), (119.99999999999999, 180.0, 'H', 'L'), (119.99999999999999, 180.0, 'V', 'R'), (119.99999999999999, 180.0, 'D', 'A'), (119.99999999999999, 180.0, 'A', 'D'), (119.99999999999999, 180.0, 'R', 'V'), (119.99999999999999, 180.0, 'L', 'H'), (180.0, 180.0, 'H', 'L'), (180.0, 180.0, 'V', 'R'), (180.0, 180.0, 'D', 'A'), (180.0, 180.0, 'A', 'D'), (180.0, 180.0, 'R', 'V'), (180.0, 180.0, 'L', 'H'), (239.99999999999997, 180.0, 'H', 'L'), (239.99999999999997, 180.0, 'V', 'R'), (239.99999999999997, 180.0, 'D', 'A'), (239.99999999999997, 180.0, 'A', 'D'), (239.99999999999997, 180.0, 'R', 'V'), (239.99999999999997, 180.0, 'L', 'H'), (299.99999999999994, 180.0, 'H', 'L'), (299.99999999999994, 180.0, 'V', 'R'), (299.99999999999994, 180.0, 'D', 'A'), (299.99999999999994, 180.0, 'A', 'D'), (299.99999999999994, 180.0, 'R', 'V'), (299.99999999999994, 180.0, 'L', 'H'), (360.0, 180.0, 'H', 'L'), (360.0, 180.0, 'V', 'R'), (360.0, 180.0, 'D', 'A'), (360.0, 180.0, 'A', 'D'), (360.0, 180.0, 'R', 'V'), (360.0, 180.0, 'L', 'H')]
"""